REST API и HTTP методы
1️⃣ Как кратко ответить
REST (Representational State Transfer) — это архитектурный стиль для создания веб-сервисов, который использует стандартные HTTP методы (GET, POST, PUT, DELETE, PATCH) для выполнения операций над ресурсами. RESTful API обменивается данными в формате JSON или XML, не хранит состояние между запросами (stateless) и использует понятные URL-адреса для идентификации ресурсов.

2️⃣ Подробное объяснение темы
Что такое REST?
REST — это набор архитектурных принципов для построения распределённых систем. API, построенное по принципам REST, называется RESTful API.

Основные принципы REST:

Клиент-сервер: Разделение ответственности между клиентом и сервером
Stateless: Каждый запрос содержит всю необходимую информацию
Кэширование: Ответы могут быть кэшированы
Единообразный интерфейс: Стандартные методы и форматы данных
Многоуровневая система: Возможность добавления промежуточных слоёв

HTTP методы и их назначение:

GET — получение ресурса (идемпотентный, безопасный)
POST — создание нового ресурса
PUT — полное обновление ресурса (идемпотентный)
PATCH — частичное обновление ресурса
DELETE — удаление ресурса (идемпотентный)

Пример REST API на FastAPI:

from fastapi import FastAPI, HTTPException
from pydantic import BaseModel
from typing import Optional
​
app = FastAPI()
​
class User(BaseModel):
    id: Optional[int] = None
    name: str
    email: str
    age: Optional[int] = None
​
users_db = {}
user_id_counter = 1
​
@app.get("/users")
def get_users():
    """Получить список всех пользователей."""
    return list(users_db.values())
​
@app.get("/users/{user_id}")
def get_user(user_id: int):
    """Получить пользователя по ID."""
    if user_id not in users_db:
        raise HTTPException(status_code=404, detail="User not found")
    return users_db[user_id]
​
@app.post("/users", status_code=201)
def create_user(user: User):
    """Создать нового пользователя."""
    global user_id_counter
    user.id = user_id_counter
    users_db[user_id_counter] = user
    user_id_counter += 1
    return user
​
@app.put("/users/{user_id}")
def update_user(user_id: int, user: User):
    """Полностью обновить пользователя."""
    if user_id not in users_db:
        raise HTTPException(status_code=404, detail="User not found")
    user.id = user_id
    users_db[user_id] = user
    return user
​
@app.patch("/users/{user_id}")
def partial_update_user(user_id: int, user_data: dict):
    """Частично обновить пользователя."""
    if user_id not in users_db:
        raise HTTPException(status_code=404, detail="User not found")
    stored_user = users_db[user_id]
    for key, value in user_data.items():
        setattr(stored_user, key, value)
    return stored_user
​
@app.delete("/users/{user_id}", status_code=204)
def delete_user(user_id: int):
    """Удалить пользователя."""
    if user_id not in users_db:
        raise HTTPException(status_code=404, detail="User not found")
    del users_db[user_id]

HTTP статус коды:

# Успешные ответы (2xx)
200 OK              # Успешный запрос
201 Created         # Ресурс создан
204 No Content      # Успешно, но без содержимого
​
# Ошибки клиента (4xx)
400 Bad Request     # Некорректный запрос
401 Unauthorized    # Требуется аутентификация
403 Forbidden       # Доступ запрещён
404 Not Found       # Ресурс не найден
422 Unprocessable   # Ошибка валидации
​
# Ошибки сервера (5xx)
500 Internal Error  # Внутренняя ошибка сервера
503 Service Unavailable  # Сервис недоступен

Правила проектирования URL:

# Хорошо — существительные во множественном числе
GET    /users           # список пользователей
GET    /users/123       # конкретный пользователь
POST   /users           # создать пользователя
GET    /users/123/orders  # заказы пользователя
​
# Плохо — глаголы в URL
GET    /getUsers
POST   /createUser
DELETE /deleteUser/123

Версионирование API:

# Через URL
/api/v1/users
/api/v2/users
​
# Через заголовки
Accept: application/vnd.myapi.v1+json

Пагинация и фильтрация:

@app.get("/users")
def get_users(
    skip: int = 0,
    limit: int = 10,
    sort_by: str = "id",
    order: str = "asc",
    name: Optional[str] = None
):
    """Получить список пользователей с пагинацией."""
    result = list(users_db.values())
    
    if name:
        result = [u for u in result if name.lower() in u.name.lower()]
    
    reverse = order == "desc"
    result.sort(key=lambda x: getattr(x, sort_by), reverse=reverse)
    
    return {
        "total": len(result),
        "items": result[skip:skip + limit]
    }

Где применяется REST API?
REST API используется повсеместно:

Веб-приложения: Взаимодействие frontend и backend
Мобильные приложения: Обмен данными с сервером
Микросервисы: Коммуникация между сервисами
Интеграции: Подключение сторонних сервисов
Публичные API: GitHub, Twitter, Stripe и др.

